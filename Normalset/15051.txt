 ken and greg what we have been doing is absoutely fine under the assumption that the market conditions move relatively small where taylor series has fast convergence however we could run into troubles when the market has a big move in order to have a error proof bucketing we can use the following method finitedifference let me know what you guys think how to implement it to the transport book sensitivity to risk parameters or p l attribution by risk buckettoday s premium premium based on today s curves last day s premium premium based on last day s curves change due to deliverycurveshift [premium based on today s delivery price and last day s receipt price volatilities interest rate last s time to expiration etc]last day s premiumtoday s change due to gamma receiptcurveshift [premium based on today s receipt price and last day s everything else]last day s premium today s change due to gamma vega [premium based on today s delivery volatility and last day s everything else]last day s premium vega as above for gas volatility rho as above for interest rate eta as above for correlation theta[premium based on today s days to expiration and last day s everything else]driftlast day s premium [this is a daily theta the sprdopt function returns an annualised theta ] gamma last day s gamma priceshiftgamma last day s gamma priceshiftdrift [ exp last day s interest rate todaylast days ] last day s premium priceshift today s delivery pricelast day s delivery price priceshift today s receipt pricelast day s receipt price gamma theoretical gamma i e gamma from spread option gamma theoretical gamma i e gamma from spread option calculation liquidationpremium of option which expired the day before i e intrinsic value 